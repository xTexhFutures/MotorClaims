@using CORE.DTOs.MotorClaim.Claims;
@using CORE.DTOs.MotorClaim;
@model Claims
@{
    Layout = null;
    List<ClaimMaster> claimMasters=(List<ClaimMaster>)ViewData["ClaimMaster"];
        ClaimMaster master = new ClaimMaster();
    master = claimMasters.Where(p => p.claims.Id == Model.Id).FirstOrDefault();
    ReserveBalance reserveBalance = new ReserveBalance()
    {
    ClaimLevel=Model.ReserveBalance.HasValue?Model.ReserveBalance.Value:0,
ClaimantLevel=master.claimants.ReserveBalance.HasValue?master.claimants.ReserveBalance.Value:0
    };  

}
<form id="frmUpdateReserve" method="post" >
    <input type="hidden" name="ClaimId" value="@Model.Id" />
    <div class="slide-popup-inner">
        <div class="slide-header">
            <div class="heading-card">
                <h2 class="heading">Update reserve</h2>
            </div>
        </div>
        <div class="slide-body">
            <div class="popup-body-wrapper">
                <div class="delete-alert">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"
                         class="alert-icon">
                        <path d="M8 7.25C7.80109 7.25 7.61033 7.32902 7.46967 7.46967C7.32902 7.61032 7.25 7.80109 7.25 8V11C7.25 11.1989 7.32902 11.3897 7.46967 11.5303C7.61033 11.671 7.80109 11.75 8 11.75C8.19892 11.75 8.38968 11.671 8.53033 11.5303C8.67099 11.3897 8.75 11.1989 8.75 11V8C8.75 7.80109 8.67099 7.61032 8.53033 7.46967C8.38968 7.32902 8.19892 7.25 8 7.25ZM8.285 4.31C8.10241 4.23499 7.8976 4.23499 7.715 4.31C7.62294 4.3457 7.53883 4.39922 7.4675 4.4675C7.40126 4.5404 7.34799 4.62411 7.31 4.715C7.26802 4.80401 7.24747 4.90162 7.25 5C7.24943 5.0987 7.26835 5.19655 7.30568 5.28793C7.343 5.37931 7.39799 5.46242 7.4675 5.5325C7.5404 5.59875 7.62412 5.65202 7.715 5.69C7.82863 5.73668 7.95198 5.75474 8.07421 5.74258C8.19645 5.73043 8.31383 5.68844 8.41604 5.6203C8.51825 5.55216 8.60215 5.45996 8.66039 5.3518C8.71862 5.24364 8.74939 5.12284 8.75 5C8.74724 4.80142 8.66955 4.61123 8.5325 4.4675C8.46118 4.39922 8.37707 4.3457 8.285 4.31ZM8 0.5C6.51664 0.5 5.0666 0.939867 3.83323 1.76398C2.59986 2.58809 1.63856 3.75943 1.07091 5.12987C0.50325 6.50032 0.354725 8.00832 0.644114 9.46318C0.933503 10.918 1.64781 12.2544 2.6967 13.3033C3.7456 14.3522 5.08197 15.0665 6.53683 15.3559C7.99168 15.6453 9.49968 15.4968 10.8701 14.9291C12.2406 14.3614 13.4119 13.4001 14.236 12.1668C15.0601 10.9334 15.5 9.48336 15.5 8C15.5 7.01509 15.306 6.03982 14.9291 5.12987C14.5522 4.21993 13.9997 3.39314 13.3033 2.6967C12.6069 2.00026 11.7801 1.44781 10.8701 1.0709C9.96019 0.693993 8.98492 0.5 8 0.5ZM8 14C6.81332 14 5.65328 13.6481 4.66658 12.9888C3.67989 12.3295 2.91085 11.3925 2.45673 10.2961C2.0026 9.19974 1.88378 7.99334 2.11529 6.82946C2.3468 5.66557 2.91825 4.59647 3.75736 3.75736C4.59648 2.91824 5.66558 2.3468 6.82946 2.11529C7.99335 1.88378 9.19975 2.0026 10.2961 2.45672C11.3925 2.91085 12.3295 3.67988 12.9888 4.66658C13.6481 5.65327 14 6.81331 14 8C14 9.5913 13.3679 11.1174 12.2426 12.2426C11.1174 13.3679 9.5913 14 8 14Z"
                              fill="#6B47F5"></path>
                    </svg>
                    <div class="delete-alert-content">
                        <h2 class="highlight-text">
                            Once you add new reserve there is no chance to delete it again.
                        </h2>

                    </div>
                </div>
                <div class="body-content-wrapper">
                    <div class="delete-content-card">
                        <div class="body-delete-header">
                            <h2 class="heading-title">@Model.ClaimNo</h2>
                            <span class="active-employee">Employee</span>
                        </div>
                        <ul class="list-detail">
                            <li class="list-item-delete">
                                <span class="label">Owner Name:</span>
                                <span class="value">@Model.Owner</span>
                            </li>
                            <li class="list-item-delete">
                                <span class="label">Policy No:</span>
                                <span class="value">@Model.PolicyNo</span>
                            </li>
                            <li class="list-item-delete">
                                <span class="label">Plate No:</span>
                                <span class="value">@Model.PlateNo</span>
                            </li>
                            <li class="list-item-delete">
                                <span class="label">Fraud Score:</span>
                                <span class="value">@Model.FraudScore</span>
                            </li>
                        </ul>

                        @{
                            await Html.RenderPartialAsync("_ReserveSummary",reserveBalance);
                        }
                        <div class="cancel-declaration">
                            <h3 class="title-label">Claimant</h3>
                            <div class="form-field-wrapper">
                                <div class="form-input-wrapper">
                                    <select required class="form-inputbox" name="ClaimantID" id="ddlClaimantID">
                                        <option value="@master.claimants.Id">@master.claimants.ClaimantName</option>

                                    
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="cancel-declaration">
                            <h3 class="title-label">Spare Part Cost</h3>
                            <div class="form-field-wrapper">
                                <div class="form-input-wrapper">
                                    <input required type="text" name="SparePartCost" autocomplete="off" maxlength="10" class="form-inputbox" id="txtSparePartCost" />

                                </div>
                            </div>
                        </div>


                        <div class="cancel-declaration">
                            <h3 class="title-label">Labor Cost</h3>
                            <div class="form-field-wrapper">
                                <div class="form-input-wrapper">
                                    <input required type="text" name="LaborCost" autocomplete="off" maxlength="10" class="form-inputbox" id="txtLaborCost" />

                                </div>
                            </div>
                        </div>


                        <div class="cancel-declaration">
                            <h3 class="title-label">Other Cost</h3>
                            <div class="form-field-wrapper">
                                <div class="form-input-wrapper">
                                    <input required type="text" name="OtherCost" autocomplete="off" maxlength="10" class="form-inputbox" id="txtOtherCost" />

                                </div>
                            </div>
                        </div>

                        <div class="cancel-declaration">
                            <h3 class="title-label">Note</h3>
                            <div class="form-field-wrapper">
                                <div class="form-input-wrapper">
                                    <textarea name="Note" id="txtNote" autocomplete="off" class="form-inputbox" maxlength="1024"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="slide-footer">
                    <div class="slide-inner-footer">
                        <button type="button" class="button button-secondary-border"
                                onclick="CloseDialogV('UpdateReserve')">
                            Cancel
                        </button>
                        <button type="submit" class="button button-primary">Update</button>
                    </div>
                </div>
            </div>
        </div>


    </div>

</form>

<script>
    $(function () {
        $("#frmUpdateReserve").submit(function (event) {
            $.post("/Surveyor/UpdateReserveTransaction/", $("#frmUpdateReserve").serializeArray(),function(){
                CloseDialogV('UpdateReserve');
            });

        });
    });

    $("#ddlClaimantID").change(function () {               
        var second = $(this).val();         
        $.post('/Operations/GetReserveBalance/' + second,function(data){
        $('#ClaimantBalance').text(data.claimantLevel);
        });
 

    });


    $('#txtSparePartCost').ForceDecimalNegativeEntry();
    $('#txtLaborCost').ForceDecimalNegativeEntry();
    $('#txtOtherCost').ForceDecimalNegativeEntry();
</script>